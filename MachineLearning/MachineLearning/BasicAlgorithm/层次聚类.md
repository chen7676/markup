# 层次聚类

层次聚类时将聚类看成是一个按层次进行数据划分的过程，算法结束后将形成一棵聚类树。层次聚类按照执行顺序不同，可分为自顶向上的合并方法，以及自顶向下的分裂方法

如果两个簇就是两个点，则他们的距离可以用距离度量的任意一个距离指标来度量，当两个簇中包含多个数据点事，衡量两个簇 $C_i,C_j$。的距离的常用方法有如下

- 最小距离

对于簇$C_i$中任意一点$p_i\in C_i$，以及簇$C_j$中任意一个点$p_j\in C_j$，最小距离由两个簇中最近的两个样本点决定
$$
d_{i,j} = \min d(p_i,p_j)
$$

- 最大距离

对于簇$C_i$中任意一点$p_i\in C_i$，以及簇$C_j$中任意一个点$p_j\in C_j$，最小距离由两个簇中最远的两个样本点决定
$$
d_{i,j} = \max d(p_i,p_j)
$$


- 平均距离

对于簇$C_i$中任意一点$p_i\in C_i$，以及簇$C_j$中任意一个点$p_j\in C_j$，最小距离由两个簇中所有样本点决定
$$
d_{i,j} = \frac{1}{|C_i||C_j|}\sum_{p_i\in C_i}\sum_{p_j\in C_j} d(p_i,p_j)
$$

## 自底向上

AGNES算法流程

```
输入：包含m个数据点{x^1,x^2,\cdots, x^m}的数据集D
输出：k个簇{C_1,C_2,\cdots,C_k}
1.将每一个数据点单独初始化为一个簇，初始化C_i = x^i，并记当前的簇数为cur = m
2.当 cur > k时，执行下面的操作，否则跳出循环
	2.1 找出距离最短的两个簇C_i和C_j(i<j)，将簇C_i和C_j的数据点合并，合并后的簇重新标记为C_i
	2.2 将簇C_{j+1},C_{j+2},\cdots,C_{cur}分别重新编号为C_j,C_{j+1},\cdots,C_{cur}
	2.3 修改cur值：cur = cur - 1
3.输出k个簇{C_1, C_2,\cdots, C_k}
```

## 自顶向下

DIANA算法流程

```
输入：包含m个数据点{x^1,x^2,\cdots, x^m}的数据集D
输出：k个簇{C_1,C_2,\cdots,C_k}
1.将全部数据点都初始化为一个簇，初始化C_1 = {x^1,x^2,\cdots,x^m}，并记当前的簇数为cur = 1
2.当 cur < k时，执行下面的操作，否则跳出循环
	2.1 找出直径最大的簇进行分裂操作
	2.2 找出簇中与其他点平均距离最大的点p,将p放入split_group中，其余点放在old_part中 
	2.3 重复下面的操作
		在old_part中找出到slit_group最近的点的距离不大于到old_part中最近点的距离的点q，将q添加进split_group中；	
		若没有找到这样的点则推出循环
	2.4 将split_group与old_part分别作为两个新的簇，编号分别为C_i和C_{cur+1}
	2.5 cur = cur + 1
3.输出k个簇{C_1, C_2,\cdots, C_k}
```



